<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Nuerlo</title>
    
    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/assets/images/NUERLO-LOGO.png">
    
    <!-- Mobile Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Nuerlo">
    <meta name="theme-color" content="#ffffff" id="themeColorMeta">
    
    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Dashboard Styles Only -->
    <link rel="stylesheet" href="/dashboard-styles.css?v=2.0">
    
    <!-- Cropper.js for image cropping -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js"></script>
    
    <style>
        /* Prevent content flash - hide body content until auth completes */
        body:not(.auth-ready) > #authProtectedContent {
            display: none !important;
        }
        
        /* Critical CSS: Force recommended grid styling */
        #recommendedGrid {
            display: grid !important;
            grid-template-columns: repeat(2, 1fr) !important;
            gap: 24px !important;
            width: 100% !important;
            min-height: 400px !important;
        }
        
        #recommendedGrid .marketplace-course-card {
            background: #ffffff !important;
            border: 1px solid #e5e7eb !important;
            border-radius: 12px !important;
            overflow: hidden !important;
            display: flex !important;
            flex-direction: column !important;
            position: relative !important;
            min-height: 400px !important;
        }
        
        @media (max-width: 768px) {
            #recommendedGrid {
                grid-template-columns: 1fr !important;
            }
        }
    </style>
    <script>
        // Safety fallback: Force show content after 5 seconds if auth check fails
        // This prevents white screen if JavaScript errors occur
        setTimeout(function() {
            try {
                const body = document.body;
                const content = document.getElementById('authProtectedContent');
                if (content && !body.classList.contains('auth-ready')) {
                    console.warn('Safety fallback triggered: Forcing content to show after 5s timeout');
                    body.classList.add('auth-ready');
                    content.style.display = 'block';
                    const loadingScreen = document.getElementById('loadingScreen');
                    if (loadingScreen) {
                        loadingScreen.classList.add('hidden');
                        loadingScreen.style.display = 'none';
                    }
                }
            } catch (e) {
                console.error('Safety fallback error:', e);
                // Last resort: try to show content anyway
                try {
                    const content = document.getElementById('authProtectedContent');
                    const loadingScreen = document.getElementById('loadingScreen');
                    if (content) content.style.display = 'block';
                    if (loadingScreen) {
                        loadingScreen.style.display = 'none';
                        loadingScreen.classList.add('hidden');
                    }
                    document.body.classList.add('auth-ready');
                } catch (e2) {
                    console.error('Last resort fallback also failed:', e2);
                }
            }
        }, 5000);
    </script>
</head>
<body class="dashboard-body">
    
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-logo">
            <img src="/assets/images/LOGO.png" alt="Nuerlo">
        </div>
    </div>

    <!-- Auth Protected Content - Hidden until Firebase confirms authentication -->
    <div id="authProtectedContent" class="auth-protected-content" style="display: none;">
    <!-- Sidebar -->
    <nav class="dashboard-sidebar" id="sidebar">
        <button class="sidebar-collapse-btn" id="sidebarToggle" title="Collapse sidebar">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        </button>
        <!-- Mobile Profile Section -->
        <div class="sidebar-mobile-profile" id="sidebarMobileProfile">
            <button class="sidebar-mobile-close-btn" onclick="toggleSidebar()" title="Close menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <div class="sidebar-mobile-profile-picture" id="sidebarMobileProfilePicture"></div>
            <div class="sidebar-mobile-profile-name" id="sidebarMobileProfileName"></div>
            <div class="sidebar-mobile-profile-email" id="sidebarMobileProfileEmail"></div>
        </div>
        
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <img src="/assets/images/LOGO.png" alt="Nuerlo">
            </div>
        </div>
        
        <div class="sidebar-content">
            <div class="sidebar-section">
                <div class="sidebar-section-title">Main</div>
                <ul class="sidebar-nav">
                    <li class="nav-item active">
                        <a href="#overview" class="nav-link" data-section="overview" data-tooltip="Overview">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="7" height="7"></rect>
                                <rect x="14" y="3" width="7" height="7"></rect>
                                <rect x="14" y="14" width="7" height="7"></rect>
                                <rect x="3" y="14" width="7" height="7"></rect>
                            </svg>
                            <span>Overview</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#programs" class="nav-link" data-section="programs" data-tooltip="My Programs">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                            </svg>
                            <span>My Programs</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#progress" class="nav-link" data-section="progress" data-tooltip="Progress">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                            </svg>
                            <span>Progress</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#resources" class="nav-link" data-section="resources" data-tooltip="Resources">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            </svg>
                            <span>Resources</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-section-title">Resources</div>
                <ul class="sidebar-nav">
                    <li class="nav-item">
                        <a href="#marketplace" class="nav-link" data-section="marketplace" data-tooltip="Marketplace">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="9" cy="21" r="1"></circle>
                                <circle cx="20" cy="21" r="1"></circle>
                                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                            </svg>
                            <span>Marketplace</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#tasks" class="nav-link" data-section="tasks" data-tooltip="Tasks">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 11l3 3 8-8"></path>
                                <path d="M20 12v6a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h9"></path>
                            </svg>
                            <span>Tasks</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#notes" class="nav-link" data-section="notes" data-tooltip="Notes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                            <span>Notes</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-section-title">Account</div>
                <ul class="sidebar-nav">
                    <li class="nav-item">
                        <a href="#payment" class="nav-link" data-section="payment" data-tooltip="Payment">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="1" y="4" width="22" height="16" rx="2"></rect>
                                <line x1="1" y1="10" x2="23" y2="10"></line>
                            </svg>
                            <span>Payment</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#help" class="nav-link" data-section="help" data-tooltip="Help">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                            <span>Help</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#profile" class="nav-link" data-section="profile" data-tooltip="Profile">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            <span>Profile</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#settings" class="nav-link" data-section="settings" data-tooltip="Settings">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"></path>
                                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                            </svg>
                            <span>Settings</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#logout" class="nav-link" id="logoutBtn" onclick="handleLogout(); return false;" data-tooltip="Logout">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                            <span>Logout</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="dashboard-main">
        <!-- Header -->
        <header class="dashboard-header">
            <button class="mobile-menu-btn" onclick="toggleSidebar()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
            
            <div class="header-left">
                <h1 class="dashboard-title">
                    <span id="titleText">Welcome, </span><span id="userName"></span>
                </h1>
            </div>
            
            <div class="header-center">
                <div class="header-search-bar">
                    <svg class="header-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21l-4.35-4.35"></path>
                    </svg>
                    <input type="text" class="header-search-input" placeholder="Search..." id="headerSearchInput" autocomplete="off">
                    <button class="header-search-clear" id="headerSearchClear" style="display: none;">Ã—</button>
                    <div class="header-search-shortcut">/</div>
                    <div class="header-search-dropdown" id="headerSearchDropdown">
                        <div class="header-search-suggestions" id="headerSearchSuggestions"></div>
                    </div>
                </div>
                </div>
            
            <div class="header-right">
                <div class="header-actions">
                    <button class="header-icon-btn theme-toggle-btn" id="themeToggle" title="Toggle theme">
                        <!-- Sun icon for dark mode (to switch to light) -->
                        <svg class="theme-icon theme-icon-sun" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke-width="2">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <!-- Moon icon for light mode (to switch to dark) -->
                        <svg class="theme-icon theme-icon-moon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke-width="2">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                    <button class="header-icon-btn notification-btn" id="notificationBtn" title="Notifications">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                    </button>
                    <button class="header-icon-btn add-btn" id="addBtn" title="Quick Actions">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                    </button>
                </div>
                <!-- Notifications Dropdown -->
                <div class="notifications-dropdown header-dropdown" id="notificationsDropdown">
                    <div class="notifications-header">
                        <span class="notifications-title">Notifications</span>
                    </div>
                    <div class="notifications-content">
                        <div class="notification-empty">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                            </svg>
                            <p>No new notifications</p>
                        </div>
                    </div>
                </div>
                <!-- Add Dropdown -->
                <div class="add-dropdown header-dropdown" id="addDropdown">
                    <div class="add-dropdown-content">
                        <button class="add-dropdown-item" data-section="profile" onclick="navigateToSection('profile'); hideAddDropdown(); return false;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            <span>Profile</span>
                        </button>
                        <button class="add-dropdown-item" data-section="payment" onclick="navigateToSection('payment'); hideAddDropdown(); return false;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="1" y="4" width="22" height="16" rx="2"></rect>
                                <line x1="1" y1="10" x2="23" y2="10"></line>
                            </svg>
                            <span>Payment</span>
                        </button>
                        <button class="add-dropdown-item" data-section="settings" onclick="navigateToSection('settings'); hideAddDropdown(); return false;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"></path>
                                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                            </svg>
                            <span>Settings</span>
                        </button>
                        <button class="add-dropdown-item" data-section="help" onclick="navigateToSection('help'); hideAddDropdown(); return false;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                            <span>Help</span>
                        </button>
                        <div class="add-dropdown-divider"></div>
                        <button class="add-dropdown-item" onclick="handleLogout(); hideAddDropdown(); return false;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                            <span>Logout</span>
                        </button>
                    </div>
                </div>
                <div class="user-profile-mini" onclick="navigateToSection('profile')">
                    <div class="user-avatar" id="userAvatar"></div>
                    <span class="user-name-mini" id="userNameMini"></span>
                </div>
            </div>
        </header>

        <!-- Dashboard Content -->
        <div class="dashboard-content">
            
            <!-- Overview Section -->
            <section id="overview" class="content-section active">
                <!-- Continue Learning -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Continue Learning</h3>
                        <a href="#programs" class="card-action" onclick="navigateToSection('programs'); return false;">View all</a>
                        </div>
                    <div id="continueContainer">
                        <div id="continueLoading" style="text-align: center; padding: 2rem 0; color: var(--color-text-tertiary); display: none;">
                            <div style="display: inline-block; width: 20px; height: 20px; border: 2px solid var(--color-border-light); border-top-color: var(--color-brand-purple); border-radius: 50%; animation: spin 0.6s linear infinite;"></div>
                                </div>
                        <div id="continueCourse" style="display: none;">
                            <div class="program-card" onclick="resumeCourse()">
                                <div class="program-thumbnail" id="continueThumbnail">
                                    <img src="" alt="Course" id="continueThumbnailImg" style="display: none;">
                                </div>
                                <div class="program-content">
                                    <div class="program-header">
                                        <h4 class="program-title" id="continueTitle">Course Title</h4>
                                        <div class="program-meta">
                                            <span id="continueMeta">12 lessons</span>
                                        </div>
                                    </div>
                                    <div class="program-progress">
                                        <div class="progress-label">
                                            <span>Progress</span>
                                            <span id="continueProgress">0%</span>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress-fill" id="continueProgressBar" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <button class="btn btn-primary" onclick="event.stopPropagation(); resumeCourse()">Continue</button>
                                </div>
                            </div>
                        </div>
                        <div id="noCourses" style="text-align: center; padding: 3rem 1rem; display: none;">
                            <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold);">Start learning</h3>
                            <a href="#marketplace" class="marketplace-explore-link" onclick="navigateToSection('marketplace'); return false;">
                                <span>Explore courses in the marketplace</span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                                    <polyline points="9 18 15 12 9 6"></polyline>
                                </svg>
                            </a>
                            </div>
                        </div>
                    </div>

                    <!-- Recommended -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Recommended for You</h3>
                        <a href="#marketplace" class="card-action" onclick="navigateToSection('marketplace'); return false;">See more</a>
                    </div>
                    <div id="recommendedGrid">
                        <!-- Loading State -->
                        <div id="recommendedLoading" style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem; color: var(--color-text-tertiary);">
                            <div style="display: inline-block; width: 24px; height: 24px; border: 2px solid var(--color-border-light); border-top-color: var(--color-brand-purple); border-radius: 50%; animation: spin 0.6s linear infinite;"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Programs Section -->
            <section id="programs" class="content-section">
                <!-- Programs Tabs Navigation - COMPLETELY SEPARATE -->
                <div class="payment-nav-container">
                    <button class="payment-nav-btn payment-nav-active" data-programs-section="allProgramsSection">
                        All Programs
                    </button>
                    <button class="payment-nav-btn" data-programs-section="notStartedSection">
                        Not Started
                    </button>
                    <button class="payment-nav-btn" data-programs-section="inProgressSection">
                        In Progress
                    </button>
                    <button class="payment-nav-btn" data-programs-section="completedSection">
                        Completed
                    </button>
                    <div class="payment-nav-underline"></div>
                </div>

                <!-- All Programs Subsection -->
                <div id="allProgramsSection" class="profile-subsection active">
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <!-- Programs Grid -->
                            <div class="programs-grid" id="programsGrid" data-filter="all">
                                <!-- Loading State -->
                                <div id="programsLoading" style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem; color: var(--color-text-tertiary);">
                                    <div style="display: inline-block; width: 24px; height: 24px; border: 2px solid var(--color-border-light); border-top-color: var(--color-brand-purple); border-radius: 50%; animation: spin 0.6s linear infinite;"></div>
                                </div>

                                <!-- Empty State -->
                                <div id="noProgramsMessage" style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem; display: none;">
                                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold);">No programs enrolled</h3>
                                    <a href="#marketplace" class="marketplace-explore-link" onclick="navigateToSection('marketplace'); return false;">
                                        <span>Explore courses in the marketplace</span>
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                                            <polyline points="9 18 15 12 9 6"></polyline>
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Not Started Subsection -->
                <div id="notStartedSection" class="profile-subsection" style="display: none;">
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <!-- Programs Grid -->
                            <div class="programs-grid" id="programsGridNotStarted" data-filter="not-started">
                                <!-- Loading State -->
                                <div id="programsLoadingNotStarted" style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem; color: var(--color-text-tertiary);">
                                    <div style="display: inline-block; width: 24px; height: 24px; border: 2px solid var(--color-border-light); border-top-color: var(--color-brand-purple); border-radius: 50%; animation: spin 0.6s linear infinite;"></div>
                                </div>

                                <!-- Empty State -->
                                <div id="noProgramsMessageNotStarted" style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem; display: none;">
                                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold);">No programs not started</h3>
                                    <p style="color: var(--color-text-tertiary); margin-bottom: 2rem; font-size: var(--font-size-sm);">You've started all your enrolled programs</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- In Progress Subsection -->
                <div id="inProgressSection" class="profile-subsection" style="display: none;">
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <!-- Programs Grid -->
                            <div class="programs-grid" id="programsGridInProgress" data-filter="in-progress">
                                <!-- Loading State -->
                                <div id="programsLoadingInProgress" style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem; color: var(--color-text-tertiary);">
                                    <div style="display: inline-block; width: 24px; height: 24px; border: 2px solid var(--color-border-light); border-top-color: var(--color-brand-purple); border-radius: 50%; animation: spin 0.6s linear infinite;"></div>
                                </div>

                                <!-- Empty State -->
                                <div id="noProgramsMessageInProgress" style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem; display: none;">
                                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold);">No programs in progress</h3>
                                    <p style="color: var(--color-text-tertiary); margin-bottom: 2rem; font-size: var(--font-size-sm);">Start a program to see it here</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Completed Subsection -->
                <div id="completedSection" class="profile-subsection" style="display: none;">
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <!-- Programs Grid -->
                            <div class="programs-grid" id="programsGridCompleted" data-filter="completed">
                                <!-- Loading State -->
                                <div id="programsLoadingCompleted" style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem; color: var(--color-text-tertiary);">
                                    <div style="display: inline-block; width: 24px; height: 24px; border: 2px solid var(--color-border-light); border-top-color: var(--color-brand-purple); border-radius: 50%; animation: spin 0.6s linear infinite;"></div>
                                </div>

                                <!-- Empty State -->
                                <div id="noProgramsMessageCompleted" style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem; display: none;">
                                    <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold);">No completed programs</h3>
                                    <p style="color: var(--color-text-tertiary); margin-bottom: 2rem; font-size: var(--font-size-sm);">Complete a program to see it here</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <script>
                // PROGRAMS NAVIGATION - COMPLETELY SEPARATE SYSTEM
                (function() {
                    let updateUnderlineFunction = null;
                    
                    function setupProgramsNav() {
                        const programsSection = document.getElementById('programs');
                        if (!programsSection) return;
                        
                        const navContainer = programsSection.querySelector('.payment-nav-container');
                        const navButtons = programsSection.querySelectorAll('.payment-nav-btn');
                        const underline = programsSection.querySelector('.payment-nav-underline');
                        
                        if (!navContainer || !navButtons.length || !underline) {
                            console.log('Programs nav elements not ready');
                            return;
                        }
                        
                        // Check which tab is active and sync content with it
                        let activeBtn = programsSection.querySelector('.payment-nav-btn.payment-nav-active');
                        
                        // If no active button, default to all programs
                        if (!activeBtn) {
                            navButtons.forEach(function(b) { b.classList.remove('payment-nav-active'); });
                            navButtons[0].classList.add('payment-nav-active');
                            activeBtn = navButtons[0];
                        }
                        
                        // Get the section ID from the active button
                        const activeSectionId = activeBtn.getAttribute('data-programs-section');
                        
                        // Hide all subsections first
                        programsSection.querySelectorAll('.profile-subsection').forEach(function(s) {
                            s.style.display = 'none';
                            s.classList.remove('active');
                        });
                        
                        // Show the subsection that matches the active tab
                        const targetSubsection = document.getElementById(activeSectionId);
                        if (targetSubsection) {
                            targetSubsection.style.display = 'block';
                            targetSubsection.classList.add('active');
                            
                            // Trigger filter update when switching tabs
                            const filterType = targetSubsection.querySelector('.programs-grid')?.getAttribute('data-filter') || 'all';
                            if (window.updateProgramsFilter) {
                                window.updateProgramsFilter(filterType);
                            }
                        } else {
                            // Fallback to all programs if target not found
                            const allProgramsSection = document.getElementById('allProgramsSection');
                            if (allProgramsSection) {
                                allProgramsSection.style.display = 'block';
                                allProgramsSection.classList.add('active');
                            }
                        }
                        
                        function updateUnderline(btn) {
                            if (!btn || !navContainer || !underline) return;
                            
                            // Use requestAnimationFrame to ensure layout is ready
                            requestAnimationFrame(function() {
                                const btnRect = btn.getBoundingClientRect();
                                const containerRect = navContainer.getBoundingClientRect();
                                
                                if (btnRect.width > 0 && containerRect.width > 0) {
                                    const left = btnRect.left - containerRect.left;
                                    const width = btnRect.width;
                                    
                                    underline.style.left = left + 'px';
                                    underline.style.width = width + 'px';
                                    underline.style.display = 'block';
                                    underline.style.opacity = '1';
                                    underline.style.visibility = 'visible';
                                } else {
                                    // Retry if not ready
                                    setTimeout(function() { updateUnderline(btn); }, 50);
                                }
                            });
                        }
                        
                        // Store function globally so it can be called from search
                        updateUnderlineFunction = updateUnderline;
                        window.updateProgramsUnderline = function(subsectionId) {
                            const btn = programsSection.querySelector(`.payment-nav-btn[data-programs-section="${subsectionId}"]`);
                            if (btn) {
                                updateUnderline(btn);
                                setTimeout(() => updateUnderline(btn), 50);
                                setTimeout(() => updateUnderline(btn), 150);
                            }
                        };
                        
                        // Position underline immediately
                        const currentActive = programsSection.querySelector('.payment-nav-btn.payment-nav-active') || navButtons[0];
                        updateUnderline(currentActive);
                        
                        // Also try multiple times to ensure it works
                        setTimeout(function() { updateUnderline(currentActive); }, 50);
                        setTimeout(function() { updateUnderline(currentActive); }, 150);
                        setTimeout(function() { updateUnderline(currentActive); }, 300);
                        
                        // Click handlers
                        navButtons.forEach(function(btn) {
                            btn.onclick = function() {
                                navButtons.forEach(function(b) { b.classList.remove('payment-nav-active'); });
                                this.classList.add('payment-nav-active');
                                updateUnderline(this);
                                
                                const sectionId = this.getAttribute('data-programs-section');
                                programsSection.querySelectorAll('.profile-subsection').forEach(function(s) {
                                    s.style.display = 'none';
                                    s.classList.remove('active');
                                });
                                
                                const target = document.getElementById(sectionId);
                                if (target) {
                                    target.style.display = 'block';
                                    target.classList.add('active');
                                    
                                    // Refresh progress data first to ensure latest info
                                    if (typeof loadProgressData === 'function') {
                                        console.log('[PROGRAMS TAB] Switching to', sectionId, '- refreshing data');
                                        loadProgressData();
                                    }
                                    
                                    // Trigger filter update when switching tabs
                                    const filterType = target.querySelector('.programs-grid')?.getAttribute('data-filter') || 'all';
                                    if (window.updateProgramsFilter) {
                                        setTimeout(() => window.updateProgramsFilter(filterType), 100);
                                    }
                                }
                            };
                        });
                    }
                    
                    // Initialize on load
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', setupProgramsNav);
                    } else {
                        setupProgramsNav();
                    }
                    
                    // Retry setup multiple times to ensure it works
                    setTimeout(setupProgramsNav, 100);
                    setTimeout(setupProgramsNav, 300);
                    setTimeout(setupProgramsNav, 600);
                    setTimeout(setupProgramsNav, 1000);
                    
                    // Watch for programs section activation
                    const programsSection = document.getElementById('programs');
                    if (programsSection) {
                        const observer = new MutationObserver(function() {
                            if (programsSection.classList.contains('active')) {
                                setTimeout(setupProgramsNav, 50);
                            }
                        });
                        observer.observe(programsSection, { attributes: true, attributeFilter: ['class'] });
                    }
                })();
                </script>
            </section>

                                    <!-- Progress Section -->
            <section id="progress" class="content-section">
                <!-- Progress Tabs Navigation -->
                <div class="progress-nav-container">
                    <button class="progress-nav-btn progress-nav-active" data-progress-section="chartSection">
                        Progress
                    </button>
                    <button class="progress-nav-btn" data-progress-section="statsSection">
                        Stats
                    </button>
                    <button class="progress-nav-btn" data-progress-section="activitySection">
                        Activity
                    </button>
                    <div class="progress-nav-underline"></div>
                </div>

                <!-- Chart Section (Main) -->
                <div id="chartSection" class="profile-subsection active">
                    <!-- Custom Dropdown -->
                    <div class="custom-dropdown-container" style="margin-bottom: var(--space-6);">
                        <div class="custom-dropdown" id="customDropdown">
                            <div class="custom-dropdown-selected" id="dropdownSelected">
                                <span id="selectedCourseText">Select course...</span>
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="custom-dropdown-options" id="dropdownOptions">
                                <!-- Options will be populated here -->
                            </div>
                        </div>
                        <span id="courseProgressText" style="color: var(--color-text-tertiary); font-size: var(--font-size-sm); font-weight: var(--font-weight-medium); margin-left: var(--space-3);"></span>
                    </div>
                    
                    <!-- No Courses Message -->
                    <div id="noCoursesMessage" style="display: none; text-align: center; padding: 3rem 1rem;">
                        <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold);">No courses enrolled</h3>
                        <p style="color: var(--color-text-tertiary); margin-bottom: 2rem; font-size: var(--font-size-sm);">Enroll in courses from the Marketplace to track your progress</p>
                    </div>
                    
                    <!-- Progress Chart -->
                    <div style="width: 100%; height: 300px; position: relative; margin-bottom: var(--space-8);">
                        <canvas id="progressLineChart" style="width: 100%; height: 100%;"></canvas>
                    </div>
                    
                    <!-- Course Details -->
                    <div id="courseDetailsSection" class="profile-info-container">
                        <div class="profile-info-content" id="courseDetailsContent">
                            <!-- Details will be inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Stats Subsection -->
                <div id="statsSection" class="profile-subsection" style="display: none;">
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Total Learning Time</div>
                                <div class="profile-field-value">
                                    <span id="totalLearningTime">0 minutes</span>
                                </div>
                            </div>
                            
                            <div class="profile-field">
                                <div class="profile-field-label">Courses Enrolled</div>
                                <div class="profile-field-value">
                                    <span id="totalCoursesEnrolled">0</span>
                                </div>
                            </div>
                            
                            <div class="profile-field">
                                <div class="profile-field-label">Courses Completed</div>
                                <div class="profile-field-value">
                                    <span id="totalCoursesCompleted">0</span>
                                </div>
                            </div>
                            
                            <div class="profile-field">
                                <div class="profile-field-label">Current Streak</div>
                                <div class="profile-field-value">
                                    <span id="currentStreak">0 days</span>
                                </div>
                            </div>
                            
                            <div class="profile-field" style="border-bottom: none;">
                                <div class="profile-field-label">Last Active</div>
                                <div class="profile-field-value">
                                    <span id="lastActive" style="color: var(--color-text-tertiary);">No activity yet</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Activity Subsection -->
                <div id="activitySection" class="profile-subsection" style="display: none;">
                    <div class="profile-info-container">
                        <div class="profile-info-content" id="activityContent">
                            <div style="text-align: center; padding: 3rem 1rem;">
                                <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold);">No recent activity</h3>
                                <p style="color: var(--color-text-tertiary); margin-bottom: 2rem; font-size: var(--font-size-sm);">Your learning activity will appear here</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <script>
                // PROGRESS NAVIGATION
                (function() {
                    function setupProgressNav() {
                        const progressSection = document.getElementById('progress');
                        if (!progressSection) return;
                        
                        const navContainer = progressSection.querySelector('.progress-nav-container');
                        const navButtons = progressSection.querySelectorAll('.progress-nav-btn');
                        const underline = progressSection.querySelector('.progress-nav-underline');
                        
                        if (!navContainer || !navButtons.length || !underline) {
                            console.log('Progress nav elements not ready');
                            return;
                        }
                        
                        let activeBtn = progressSection.querySelector('.progress-nav-btn.progress-nav-active');
                        
                        if (!activeBtn) {
                            navButtons.forEach(function(b) { b.classList.remove('progress-nav-active'); });
                            navButtons[0].classList.add('progress-nav-active');
                            activeBtn = navButtons[0];
                        }
                        
                        const activeSectionId = activeBtn.getAttribute('data-progress-section');
                        
                        progressSection.querySelectorAll('.profile-subsection').forEach(function(s) {
                            s.style.display = 'none';
                            s.classList.remove('active');
                        });
                        
                        const targetSubsection = document.getElementById(activeSectionId);
                        if (targetSubsection) {
                            targetSubsection.style.display = 'block';
                            targetSubsection.classList.add('active');
                        } else {
                            const chartSection = document.getElementById('chartSection');
                            if (chartSection) {
                                chartSection.style.display = 'block';
                                chartSection.classList.add('active');
                            }
                        }
                        
                        function updateUnderline(btn) {
                            if (!btn || !navContainer || !underline) return;
                            
                            requestAnimationFrame(function() {
                                const btnRect = btn.getBoundingClientRect();
                                const containerRect = navContainer.getBoundingClientRect();
                                
                                if (btnRect.width > 0 && containerRect.width > 0) {
                                    const left = btnRect.left - containerRect.left;
                                    const width = btnRect.width;
                                    
                                    underline.style.left = left + 'px';
                                    underline.style.width = width + 'px';
                                    underline.style.display = 'block';
                                    underline.style.opacity = '1';
                                    underline.style.visibility = 'visible';
                                } else {
                                    setTimeout(function() { updateUnderline(btn); }, 50);
                                }
                            });
                        }
                        
                        const currentActive = progressSection.querySelector('.progress-nav-btn.progress-nav-active') || navButtons[0];
                        updateUnderline(currentActive);
                        
                        setTimeout(function() { updateUnderline(currentActive); }, 50);
                        setTimeout(function() { updateUnderline(currentActive); }, 150);
                        
                        navButtons.forEach(function(btn) {
                            btn.addEventListener('click', function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                                
                                const targetSectionId = btn.getAttribute('data-progress-section');
                                if (!targetSectionId) return;
                                
                                navButtons.forEach(function(b) { b.classList.remove('progress-nav-active'); });
                                btn.classList.add('progress-nav-active');
                                
                                progressSection.querySelectorAll('.profile-subsection').forEach(function(s) {
                                    s.style.display = 'none';
                                    s.classList.remove('active');
                                });
                                
                                const targetSection = document.getElementById(targetSectionId);
                                if (targetSection) {
                                    targetSection.style.display = 'block';
                                    setTimeout(function() {
                                        targetSection.classList.add('active');
                                        
                                        // Redraw chart if switching to chart section
                                        if (targetSectionId === 'chartSection' && window.chartProgressData) {
                                            setTimeout(function() {
                                                if (window.drawLineChartGlobal) {
                                                    window.drawLineChartGlobal(window.chartProgressData);
                                                }
                                            }, 100);
                                        }
                                    }, 10);
                                }
                                
                                updateUnderline(btn);
                                setTimeout(function() { updateUnderline(btn); }, 50);
                            });
                        });
                    }
                    
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', function() {
                            setTimeout(setupProgressNav, 100);
                        });
                    } else {
                        setTimeout(setupProgressNav, 100);
                    }
                })();
                </script>
            </section>

            <!-- Resources Section -->
            <section id="resources" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Saved Resources</h3>
                    </div>
                    <div class="programs-grid" id="resourcesGrid">
                        <div style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem;">
                            <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold);">No saved resources</h3>
                            <p style="color: var(--color-text-tertiary); margin-bottom: 2rem; font-size: var(--font-size-sm);">Save courses, articles, and materials for quick access</p>
                        </div>
                    </div>
                    </div>
            </section>

            <!-- Marketplace Section -->
            <section id="marketplace" class="content-section">
                <!-- Search and Filters Container -->
                <div class="marketplace-controls-wrapper">
                    <div class="search-container">
                        <div class="marketplace-search-wrapper" id="marketplaceSearchWrapper">
                        <svg class="marketplace-search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="M21 21l-4.35-4.35"></path>
                            </svg>
                        <input type="text" class="marketplace-search-input" placeholder="Search programs..." id="marketplaceSearch" autocomplete="off">
                        <div class="marketplace-search-dropdown" id="marketplaceSearchDropdown" style="display: none;">
                            <div class="marketplace-search-suggestions" id="marketplaceSearchSuggestions"></div>
                        </div>
                    </div>
                    <button class="filter-toggle-btn" onclick="toggleFilters()" id="marketplaceFilterToggle">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="4" y1="21" x2="4" y2="14"></line>
                            <line x1="4" y1="10" x2="4" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12" y2="3"></line>
                            <line x1="20" y1="21" x2="20" y2="16"></line>
                            <line x1="20" y1="12" x2="20" y2="3"></line>
                            <line x1="1" y1="14" x2="7" y2="14"></line>
                            <line x1="9" y1="8" x2="15" y2="8"></line>
                            <line x1="17" y1="16" x2="23" y2="16"></line>
                                </svg>
                            </button>
                    </div>
                    
                    <!-- Filter Dropdown (appears under search) -->
                    <div class="marketplace-filter-dropdown" id="marketplaceFilterDropdown" style="display: none;">
                        <div class="filter-row">
                            <div class="filter-group">
                                <span class="filter-label">Category</span>
                                <div class="filter-options" id="categoryFilterOptions">
                                    <button class="filter-chip active" data-filter-type="category" data-value="all">All</button>
                                    <button class="filter-chip" data-filter-type="category" data-value="favorited">Favorited</button>
                                    <button class="filter-chip" data-filter-type="category" data-value="ai-writing">AI Writing</button>
                                    <button class="filter-chip" data-filter-type="category" data-value="ai-design">AI Design</button>
                                    <button class="filter-chip" data-filter-type="category" data-value="ai-coding">AI Coding</button>
                                    <button class="filter-chip" data-filter-type="category" data-value="ai-data">AI Data Analysis</button>
                                    <button class="filter-chip" data-filter-type="category" data-value="ai-marketing">AI Marketing</button>
                                    <button class="filter-chip" data-filter-type="category" data-value="automation">Automation</button>
                                    <button class="filter-chip" data-filter-type="category" data-value="productivity">Productivity</button>
                                    <span class="filter-underline"></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="filter-row">
                            <div class="filter-group">
                                <span class="filter-label">Skill Level</span>
                                <div class="filter-options" id="difficultyFilterOptions">
                                    <button class="filter-chip active" data-filter-type="difficulty" data-value="all">All Levels</button>
                                    <button class="filter-chip" data-filter-type="difficulty" data-value="absolute-beginner">Absolute Beginner</button>
                                    <button class="filter-chip" data-filter-type="difficulty" data-value="beginner">Beginner</button>
                                    <button class="filter-chip" data-filter-type="difficulty" data-value="intermediate">Intermediate</button>
                                    <button class="filter-chip" data-filter-type="difficulty" data-value="advanced">Advanced</button>
                                    <button class="filter-chip" data-filter-type="difficulty" data-value="expert">Expert</button>
                                    <span class="filter-underline"></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="filter-row">
                            <div class="filter-group">
                                <span class="filter-label">Duration</span>
                                <div class="filter-options" id="durationFilterOptions">
                                    <button class="filter-chip active" data-filter-type="duration" data-value="all">Any Length</button>
                                    <button class="filter-chip" data-filter-type="duration" data-value="short">Under 4 weeks</button>
                                    <button class="filter-chip" data-filter-type="duration" data-value="medium">4-8 weeks</button>
                                    <button class="filter-chip" data-filter-type="duration" data-value="long">8-12 weeks</button>
                                    <button class="filter-chip" data-filter-type="duration" data-value="extended">12+ weeks</button>
                                    <span class="filter-underline"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                                
                <!-- Marketplace Grid -->
                <div class="programs-grid" id="marketplaceGrid">
                    <!-- Loading State -->
                    <div id="marketplaceLoading" style="grid-column: 1/-1; text-align: center; padding: 3rem 1rem; color: var(--color-text-tertiary);">
                        <div style="display: inline-block; width: 24px; height: 24px; border: 2px solid var(--color-border-light); border-top-color: var(--color-brand-purple); border-radius: 50%; animation: spin 0.6s linear infinite;"></div>
                                        </div>
                                    </div>
            </section>

            <!-- Tasks Section -->
            <section id="tasks" class="content-section">
                <div class="card">
                    <div style="text-align: center; padding: 3rem 1rem;">
                        <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold);">No tasks</h3>
                        <p style="color: var(--color-text-tertiary); margin-bottom: 2rem; font-size: var(--font-size-sm);">Assignments and deadlines will appear here</p>
                    </div>
                </div>
            </section>

            <!-- Notes Section -->
            <section id="notes" class="content-section">
                <div class="card">
                    <div class="card-header">
                        <a href="#" class="card-action" onclick="createNewNote(); return false;">New Note</a>
                    </div>
                    <div id="notesList" style="display: flex; flex-direction: column; gap: var(--space-3);">
                        <div style="text-align: center; padding: 3rem 1rem;">
                            <h3 style="color: var(--color-text-primary); margin-bottom: 0.5rem; font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold);">No notes yet</h3>
                            <p style="color: var(--color-text-tertiary); margin-bottom: 2rem; font-size: var(--font-size-sm);">Create notes to track your learning and ideas</p>
                        </div>
                        </div>
                    </div>
            </section>

            <!-- Payment Section -->
            <section id="payment" class="content-section">
                <!-- Payment Tabs Navigation - COMPLETELY SEPARATE -->
                <div class="payment-nav-container">
                    <button class="payment-nav-btn payment-nav-active" data-payment-section="subscriptionInfoSection">
                        Subscription
                    </button>
                    <button class="payment-nav-btn" data-payment-section="plansSection">
                        Plans
                    </button>
                    <button class="payment-nav-btn" data-payment-section="paymentMethodSection">
                        Payment Method
                    </button>
                    <button class="payment-nav-btn" data-payment-section="billingHistorySection">
                        Billing History
                    </button>
                    <div class="payment-nav-underline"></div>
                </div>

                <!-- Subscription Info Subsection -->
                <div id="subscriptionInfoSection" class="profile-subsection active">
                    <div class="profile-info-container">
                        <div class="profile-info-content" id="paymentSection">
                            <!-- Subscription UI will be loaded here by stripe-subscriptions.js -->
                            <div style="text-align: center; padding: 3rem 1rem;">
                                <div class="loading-spinner" style="margin: 0 auto;"></div>
                                <p style="color: var(--color-text-tertiary); margin-top: 1rem;">Loading subscription...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Plans Subsection -->
                <div id="plansSection" class="profile-subsection" style="display: none;">
                    <div class="profile-info-container">
                        <div class="profile-info-content" id="plansContent">
                            <!-- Plans will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Payment Method Subsection -->
                <div id="paymentMethodSection" class="profile-subsection" style="display: none;">
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Payment Method</div>
                                <div class="profile-field-value" id="paymentMethodDisplay">
                                    <span style="color: var(--color-text-tertiary);">No payment method on file</span>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Billing Address</div>
                                <div class="profile-field-value" id="billingAddressDisplay">
                                    <span style="color: var(--color-text-tertiary);">Not set</span>
                                </div>
                            </div>
                            <div class="profile-field" style="border-bottom: none;">
                                <div class="profile-field-label">Actions</div>
                                <div class="profile-field-value">
                                    <a href="#" class="plan-action-link" id="managePaymentMethodBtn">
                                        Manage Payment Method
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left: 4px;">
                                            <polyline points="9 18 15 12 9 6"></polyline>
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Billing History Subsection -->
                <div id="billingHistorySection" class="profile-subsection" style="display: none;">
                    <div class="profile-info-container">
                        <div class="profile-info-content" id="billingHistoryContent">
                            <!-- Billing history will be loaded here -->
                            <div style="text-align: center; padding: 3rem 1rem; color: var(--color-text-tertiary);">
                                <div class="loading-spinner" style="margin: 0 auto;"></div>
                                <p style="color: var(--color-text-tertiary); margin-top: 1rem;">Loading billing history...</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <script>
                // PAYMENT NAVIGATION - COMPLETELY SEPARATE SYSTEM
                (function() {
                    let updateUnderlineFunction = null;
                    
                    function setupPaymentNav() {
                        const paymentSection = document.getElementById('payment');
                        if (!paymentSection) return;
                        
                        const navContainer = paymentSection.querySelector('.payment-nav-container');
                        const navButtons = paymentSection.querySelectorAll('.payment-nav-btn');
                        const underline = paymentSection.querySelector('.payment-nav-underline');
                        
                        if (!navContainer || !navButtons.length || !underline) {
                            console.log('Payment nav elements not ready');
                            return;
                        }
                        
                        // Check which tab is active and sync content with it
                        let activeBtn = paymentSection.querySelector('.payment-nav-btn.payment-nav-active');
                        
                        // If no active button, default to subscription
                        if (!activeBtn) {
                            navButtons.forEach(function(b) { b.classList.remove('payment-nav-active'); });
                            navButtons[0].classList.add('payment-nav-active');
                            activeBtn = navButtons[0];
                        }
                        
                        // Get the section ID from the active button
                        const activeSectionId = activeBtn.getAttribute('data-payment-section');
                        
                        // Hide all subsections first
                        paymentSection.querySelectorAll('.profile-subsection').forEach(function(s) {
                            s.style.display = 'none';
                            s.classList.remove('active');
                        });
                        
                        // Show the subsection that matches the active tab
                        const targetSubsection = document.getElementById(activeSectionId);
                        if (targetSubsection) {
                            targetSubsection.style.display = 'block';
                            targetSubsection.classList.add('active');
                        } else {
                            // Fallback to subscription if target not found
                            const subscriptionSection = document.getElementById('subscriptionInfoSection');
                            if (subscriptionSection) {
                                subscriptionSection.style.display = 'block';
                                subscriptionSection.classList.add('active');
                            }
                        }
                        
                        function updateUnderline(btn) {
                            if (!btn || !navContainer || !underline) return;
                            
                            // Use requestAnimationFrame to ensure layout is ready
                            requestAnimationFrame(function() {
                                const btnRect = btn.getBoundingClientRect();
                                const containerRect = navContainer.getBoundingClientRect();
                                
                                if (btnRect.width > 0 && containerRect.width > 0) {
                                    const left = btnRect.left - containerRect.left;
                                    const width = btnRect.width;
                                    
                                    underline.style.left = left + 'px';
                                    underline.style.width = width + 'px';
                                    underline.style.display = 'block';
                                    underline.style.opacity = '1';
                                    underline.style.visibility = 'visible';
                                } else {
                                    // Retry if not ready
                                    setTimeout(function() { updateUnderline(btn); }, 50);
                                }
                            });
                        }
                        
                        // Store function globally so it can be called from search
                        updateUnderlineFunction = updateUnderline;
                        window.updatePaymentUnderline = function(subsectionId) {
                            const btn = paymentSection.querySelector(`.payment-nav-btn[data-payment-section="${subsectionId}"]`);
                            if (btn) {
                                updateUnderline(btn);
                                setTimeout(() => updateUnderline(btn), 50);
                                setTimeout(() => updateUnderline(btn), 150);
                            }
                        };
                        
                        // Position underline immediately
                        const currentActive = paymentSection.querySelector('.payment-nav-btn.payment-nav-active') || navButtons[0];
                        updateUnderline(currentActive);
                        
                        // Also try multiple times to ensure it works
                        setTimeout(function() { updateUnderline(currentActive); }, 50);
                        setTimeout(function() { updateUnderline(currentActive); }, 150);
                        setTimeout(function() { updateUnderline(currentActive); }, 300);
                        
                        // Click handlers
                        navButtons.forEach(function(btn) {
                            btn.onclick = function() {
                                navButtons.forEach(function(b) { b.classList.remove('payment-nav-active'); });
                                this.classList.add('payment-nav-active');
                                updateUnderline(this);
                                
                                const sectionId = this.getAttribute('data-payment-section');
                                paymentSection.querySelectorAll('.profile-subsection').forEach(function(s) {
                                    s.style.display = 'none';
                                    s.classList.remove('active');
                                });
                                
                                const target = document.getElementById(sectionId);
                                if (target) {
                                    target.style.display = 'block';
                                    target.classList.add('active');
                                }
                            };
                        });
                    }
                    
                    // Run immediately and multiple times
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', setupPaymentNav);
                    } else {
                        setupPaymentNav();
                    }
                    
                    setTimeout(setupPaymentNav, 100);
                    setTimeout(setupPaymentNav, 300);
                    setTimeout(setupPaymentNav, 600);
                    setTimeout(setupPaymentNav, 1000);
                    
                    // Watch for payment section activation
                    const paymentSection = document.getElementById('payment');
                    if (paymentSection) {
                        // Check if already active on load
                        if (paymentSection.classList.contains('active')) {
                            setTimeout(setupPaymentNav, 50);
                        }
                        
                        const observer = new MutationObserver(function() {
                            if (paymentSection.classList.contains('active')) {
                                setTimeout(setupPaymentNav, 50);
                            }
                        });
                        observer.observe(paymentSection, { attributes: true, attributeFilter: ['class'] });
                    }
                })();
                </script>
            </section>

            <!-- Help Section -->
            <section id="help" class="content-section">
                <div class="help-container">
                    <div class="help-search-wrapper">
                        <div class="help-search-input-wrapper">
                            <svg class="help-search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="M21 21l-4.35-4.35"></path>
                            </svg>
                            <input type="text" class="help-search-field" placeholder="Search for help..." id="helpSearchInput" autocomplete="off">
                            <button class="help-search-clear" id="helpSearchClear" style="display: none;" aria-label="Clear search">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="help-questions">
                        <h2 class="help-questions-title">Common questions</h2>
                        <div class="help-questions-list">
                            <div class="help-question-wrapper">
                                <a href="#" class="help-question" data-question="dashboard-navigation">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I navigate the dashboard?</h3>
                                        <p class="help-question-preview">Learn how to use the sidebar, switch between sections, and find what you need</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Use the sidebar on the left to navigate between sections</li>
                                        <li>Click on Overview, Programs, Progress, or Marketplace to switch areas</li>
                                        <li>The header contains a search bar for quick access</li>
                                        <li>Press "/" to focus the search bar with keyboard shortcuts</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper">
                                <a href="#" class="help-question" data-question="enroll-course">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I enroll in a course?</h3>
                                        <p class="help-question-preview">Step-by-step guide to finding and enrolling in courses from the marketplace</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Go to the Marketplace section from the sidebar</li>
                                        <li>Browse available courses or use the search function</li>
                                        <li>Click on a course to view details</li>
                                        <li>Click "Enroll" or "Get Started" to begin</li>
                                        <li>Enrolled courses appear in your Programs section</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper">
                                <a href="#" class="help-question" data-question="track-progress">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I track my learning progress?</h3>
                                        <p class="help-question-preview">Understanding your progress dashboard, completion rates, and achievements</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>View overall learning statistics in the Progress section</li>
                                        <li>See completion rates for all enrolled courses</li>
                                        <li>Visual progress bars and completion percentages</li>
                                        <li>Filter by time period (week, month, year)</li>
                                        <li>Individual course progress shown in Programs section</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper">
                                <a href="#" class="help-question" data-question="manage-account">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I manage my account settings?</h3>
                                        <p class="help-question-preview">Update your profile, change password, and manage account preferences</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Go to Profile section to update display name, email, and picture</li>
                                        <li>Change password from the Settings section</li>
                                        <li>Manage notification preferences in Settings</li>
                                        <li>Switch between light and dark mode themes</li>
                                        <li>Adjust privacy options from Settings</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper">
                                <a href="#" class="help-question" data-question="payment-billing">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I update my payment method?</h3>
                                        <p class="help-question-preview">Manage subscriptions, update billing information, and view payment history</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Go to Payment section from the sidebar</li>
                                        <li>Update credit card information securely</li>
                                        <li>Change billing address</li>
                                        <li>View subscription status and payment history</li>
                                        <li>Click "Update Payment Method" to add new cards</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper">
                                <a href="#" class="help-question" data-question="cancel-subscription">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I cancel my subscription?</h3>
                                        <p class="help-question-preview">Steps to cancel your subscription and understand what happens after cancellation</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Go to the Payment section from the sidebar</li>
                                        <li>Click on "Manage Subscription" or "Subscription Settings"</li>
                                        <li>Select "Cancel Subscription" option</li>
                                        <li>Confirm cancellation when prompted</li>
                                        <li>You'll retain access until the end of your current billing period</li>
                                        <li>No refunds are provided for partial billing periods</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="refund-policy">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">What is your refund policy?</h3>
                                        <p class="help-question-preview">Understanding refund eligibility, processing times, and how to request a refund</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Refunds are available within 30 days of purchase</li>
                                        <li>Course completion over 50% may affect refund eligibility</li>
                                        <li>Contact support to initiate a refund request</li>
                                        <li>Refunds are processed within 5-10 business days</li>
                                        <li>Refunds are issued to the original payment method</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="billing-cycle">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">When will I be charged for my subscription?</h3>
                                        <p class="help-question-preview">Understanding billing cycles, renewal dates, and payment schedules</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Subscriptions are billed monthly or annually based on your plan</li>
                                        <li>You'll be charged on the same date each billing cycle</li>
                                        <li>View your next billing date in the Payment section</li>
                                        <li>You'll receive an email notification before each charge</li>
                                        <li>Failed payments will result in service suspension after 3 attempts</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="access-courses">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I access my enrolled courses?</h3>
                                        <p class="help-question-preview">Find and continue your courses from the Programs section</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>All enrolled courses are in the Programs section</li>
                                        <li>Click "My Programs" in the sidebar to view courses</li>
                                        <li>Filter by category or sort by recent activity</li>
                                        <li>Search for specific courses</li>
                                        <li>Click any course card to continue learning</li>
                                        <li>Progress is automatically saved</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="change-plan">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I change my subscription plan?</h3>
                                        <p class="help-question-preview">Upgrade or downgrade your subscription plan and understand prorated billing</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Go to the Payment section from the sidebar</li>
                                        <li>Click "Change Plan" or "Upgrade/Downgrade"</li>
                                        <li>Select your desired plan and review pricing</li>
                                        <li>Upgrades take effect immediately with prorated charges</li>
                                        <li>Downgrades take effect at the end of your current billing period</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="certificates">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I get my certificates?</h3>
                                        <p class="help-question-preview">Learn about earning and downloading course completion certificates</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Complete all lessons and assessments to earn a certificate</li>
                                        <li>Certificates are automatically issued upon completion</li>
                                        <li>Save courses and materials in the Resources section</li>
                                        <li>Access your saved content anytime</li>
                                        <li>Organize materials for quick reference</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="payment-failed">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">My payment failed. What should I do?</h3>
                                        <p class="help-question-preview">Troubleshooting payment failures and updating payment information</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Check that your payment method has sufficient funds</li>
                                        <li>Verify your card hasn't expired</li>
                                        <li>Update your payment method in the Payment section</li>
                                        <li>Contact your bank if the issue persists</li>
                                        <li>We'll retry payment automatically up to 3 times</li>
                                        <li>Contact support if payment continues to fail</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="reset-password">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I reset my password?</h3>
                                        <p class="help-question-preview">Steps to reset your password if you've forgotten it or want to change it</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Go to the login page and click "Forgot Password"</li>
                                        <li>Enter your email address</li>
                                        <li>Check your email for a password reset link</li>
                                        <li>Click the link and create a new password</li>
                                        <li>Or change your password from Settings if you're logged in</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="delete-account">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I delete my account?</h3>
                                        <p class="help-question-preview">Permanently delete your account and understand what data will be removed</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Go to Settings section from the sidebar</li>
                                        <li>Scroll to "Account" or "Privacy" section</li>
                                        <li>Click "Delete Account" or "Close Account"</li>
                                        <li>Confirm deletion when prompted</li>
                                        <li>All your data will be permanently deleted</li>
                                        <li>This action cannot be undone</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="download-content">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">Can I download course content?</h3>
                                        <p class="help-question-preview">Understanding what content can be downloaded and offline access options</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Some course materials can be downloaded for offline viewing</li>
                                        <li>Look for download icons on individual lessons</li>
                                        <li>PDFs and documents are typically available for download</li>
                                        <li>Video content may have limited offline access</li>
                                        <li>Downloaded content is for personal use only</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="mobile-app">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">Is there a mobile app available?</h3>
                                        <p class="help-question-preview">Information about mobile apps and accessing courses on mobile devices</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Yes, we have mobile apps for iOS and Android</li>
                                        <li>Download from the App Store or Google Play Store</li>
                                        <li>Access all your courses and progress on mobile</li>
                                        <li>Sync your progress across all devices</li>
                                        <li>The mobile app works with your existing account</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="gift-courses">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">Can I gift a course to someone?</h3>
                                        <p class="help-question-preview">How to purchase and send courses as gifts to friends or family</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Yes, you can purchase courses as gifts</li>
                                        <li>Select "Gift this course" when viewing a course</li>
                                        <li>Enter the recipient's email address</li>
                                        <li>Add a personal message if desired</li>
                                        <li>The recipient will receive an email with access instructions</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="course-prerequisites">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">Do courses have prerequisites?</h3>
                                        <p class="help-question-preview">Understanding course requirements and recommended prior knowledge</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Some courses have prerequisites listed in the course description</li>
                                        <li>Check the course details page for requirements</li>
                                        <li>Prerequisites are usually recommended, not required</li>
                                        <li>You can still enroll and learn at your own pace</li>
                                        <li>Instructors provide guidance for beginners when needed</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="technical-issues">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">I'm experiencing technical issues</h3>
                                        <p class="help-question-preview">Troubleshooting common problems and getting technical support</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Refresh the page</li>
                                        <li>Clear your browser cache</li>
                                        <li>Try a different browser</li>
                                        <li>Check your internet connection</li>
                                        <li>If issues persist, contact support with details</li>
                                        <li>Include what you were doing and any error messages</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="video-playback">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">Videos won't play or are buffering</h3>
                                        <p class="help-question-preview">Troubleshooting video playback issues and improving streaming quality</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Check your internet connection speed</li>
                                        <li>Try lowering the video quality in player settings</li>
                                        <li>Close other applications using bandwidth</li>
                                        <li>Clear your browser cache and cookies</li>
                                        <li>Try a different browser or device</li>
                                        <li>Contact support if the issue persists</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="notifications">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I manage notifications?</h3>
                                        <p class="help-question-preview">Control email and push notifications for courses, updates, and reminders</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Go to Settings section from the sidebar</li>
                                        <li>Click on "Notifications" or "Notification Preferences"</li>
                                        <li>Toggle email notifications on or off</li>
                                        <li>Enable or disable push notifications</li>
                                        <li>Customize which types of notifications you receive</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="course-instructor">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How do I contact a course instructor?</h3>
                                        <p class="help-question-preview">Ways to reach out to instructors with questions or feedback</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Instructors often respond to course discussions and Q&A sections</li>
                                        <li>Create notes to track your learning progress</li>
                                        <li>Some courses have direct messaging available</li>
                                        <li>Check the course page for instructor contact information</li>
                                        <li>Response times vary by instructor</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="lifetime-access">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">Do I have lifetime access to courses?</h3>
                                        <p class="help-question-preview">Understanding course access duration and subscription requirements</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Individual course purchases typically include lifetime access</li>
                                        <li>Subscription-based access requires an active subscription</li>
                                        <li>Check the course details for specific access terms</li>
                                        <li>Lifetime access means you can revisit the course anytime</li>
                                        <li>Course updates are included with lifetime access</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="course-updates">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">Will I get updates when courses are updated?</h3>
                                        <p class="help-question-preview">Understanding how course updates work and when you'll be notified</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>Yes, you'll be notified when enrolled courses are updated</li>
                                        <li>Updates are automatically available in your enrolled courses</li>
                                        <li>Check your notifications or email for update announcements</li>
                                        <li>New content is added without additional charges</li>
                                        <li>Your progress is preserved when courses are updated</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="help-question-wrapper" style="display: none;">
                                <a href="#" class="help-question" data-question="privacy-data">
                                    <div class="help-question-content">
                                        <h3 class="help-question-text">How is my personal data protected?</h3>
                                        <p class="help-question-preview">Understanding our privacy policy and data protection measures</p>
                                    </div>
                                    <svg class="help-question-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </a>
                                <div class="help-question-answer">
                                    <ul>
                                        <li>We use industry-standard encryption to protect your data</li>
                                        <li>Payment information is processed through secure third-party providers</li>
                                        <li>We never share your personal information with third parties</li>
                                        <li>You can review our full privacy policy in Settings</li>
                                        <li>Contact us if you have privacy concerns</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <button class="help-view-more" id="helpViewMore">
                            <span>View More</span>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                    </div>

                    <div class="help-contact">
                        <div class="help-contact-content">
                            <h3 class="help-contact-title">Need more help?</h3>
                            <p class="help-contact-description">Reach the team or jump back into your own resources anytime.</p>
                            
                            <div class="help-contact-links">
                                <a href="#" data-action="contact">Contact support</a>
                                <a href="#" data-action="notes">My notes</a>
                                <a href="#" data-action="tutorials">Video tutorials</a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profile" class="content-section">
                <!-- Profile Header Section -->
                <div class="profile-header-section">
                            <div class="profile-picture-wrapper" style="cursor: pointer; position: relative; z-index: 10;">
                                <input type="file" id="profilePictureInput" accept="image/*" style="display: none;" onchange="handleProfilePictureChange(this)">
                                <img id="profilePicture" class="profile-picture" src="" alt="Profile Picture" onclick="var inp = document.getElementById('profilePictureInput'); inp.click();" style="cursor: pointer; z-index: 11; position: relative;">
                                <div class="profile-picture-overlay" onclick="var inp = document.getElementById('profilePictureInput'); inp.click();" style="cursor: pointer; z-index: 12; position: absolute;">
                                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                                        <circle cx="12" cy="13" r="4"></circle>
                                    </svg>
                                </div>
                            </div>
                            <div class="profile-info">
                                <h2 class="profile-name" id="profileDisplayName"></h2>
                                <div class="profile-meta">
                                    <div class="profile-email" id="profileEmail"></div>
                                    <div class="profile-member-since" id="profileStatus">Status: Free</div>
                                </div>
                            </div>
                </div>

                <!-- Profile Tabs Navigation -->
                <div class="profile-tabs">
                    <button class="profile-tab active" data-section="personalInfoSection">
                        Personal
                    </button>
                    <button class="profile-tab" data-section="googleAccountSection">
                        Account
                    </button>
                    <button class="profile-tab" data-section="preferencesSection">
                        Preferences
                    </button>
                    <button class="profile-tab" data-section="advancedSection">
                        Advanced
                    </button>
                    <div class="profile-tab-indicator"></div>
                </div>

                <!-- Personal Information Subsection -->
                <div id="personalInfoSection" class="profile-subsection active">
                            <div class="profile-info-container">
                                <div class="profile-info-content">
                                    <div class="profile-field">
                                        <div class="profile-field-label">Name</div>
                                        <div class="profile-field-value" id="profileNameDisplay">
                                            <span id="profileNameText"></span>
                                            <div class="profile-field-inputs" style="display: none;">
                                                <input type="text" class="profile-field-input" id="firstName" placeholder="First name" autocomplete="given-name" aria-label="First name">
                                                <input type="text" class="profile-field-input" id="lastName" placeholder="Last name" autocomplete="family-name" aria-label="Last name">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field">
                                        <div class="profile-field-label">Email</div>
                                        <div class="profile-field-value" id="profileEmailDisplay">
                                            <span id="profileEmailText"></span>
                                            <input type="email" class="profile-field-input" id="email" placeholder="your@email.com" readonly style="display: none;" autocomplete="email" aria-label="Email address">
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field">
                                        <div class="profile-field-label">Password</div>
                                        <div class="profile-field-value" id="profilePasswordDisplay">
                                            <!-- Show password dots when user HAS password -->
                                            <span id="profilePasswordText" style="display: none;">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</span>
                                            <button class="profile-change-password-btn" id="changePasswordBtn" style="display: none;">Change Password</button>
                                            
                                            <!-- Set Password for users without password -->
                                            <div id="setPasswordContainer" style="display: none;">
                                                <div style="display: flex; align-items: center; gap: 8px;">
                                                    <button class="profile-set-password-btn" id="setPasswordBtnPersonal">
                                                        Set Password
                                                    </button>
                                                    <span class="password-alert-badge" id="passwordAlertBadge">!</span>
                                                </div>
                                                
                                                <!-- Password Setup Form -->
                                                <form
                                                    id="setPasswordFormPersonal"
                                                    class="set-password-form-minimal"
                                                    style="display: none;"
                                                    autocomplete="off"
                                                    novalidate
                                                    onsubmit="event.preventDefault();"
                                                >
                                                    <input
                                                        type="text"
                                                        id="setPasswordUsernameField"
                                                        name="username"
                                                        autocomplete="username"
                                                        aria-hidden="true"
                                                        aria-label="Account email address"
                                                        tabindex="-1"
                                                        data-username-field
                                                        style="position: absolute; left: -9999px; opacity: 0; pointer-events: none; height: 1px; width: 1px;"
                                                    >
                                                    <div class="password-form-field">
                                                        <label for="newPasswordInputPersonal">New Password</label>
                                                        <input
                                                            type="password"
                                                            id="newPasswordInputPersonal"
                                                            placeholder="Enter a secure password"
                                                            class="profile-field-input"
                                                            autocomplete="new-password"
                                                        >
                                                    </div>
                                                    <div class="password-form-field">
                                                        <label for="confirmPasswordInputPersonal">Confirm Password</label>
                                                        <input
                                                            type="password"
                                                            id="confirmPasswordInputPersonal"
                                                            placeholder="Confirm your password"
                                                            class="profile-field-input"
                                                            autocomplete="new-password"
                                                        >
                                                    </div>
                                                    <div style="display: flex; gap: 16px; margin-top: 12px;">
                                                        <button type="button" class="profile-save-password-btn" id="savePasswordBtnPersonal">Save</button>
                                                        <button type="button" class="profile-cancel-password-btn" id="cancelPasswordBtnPersonal">Cancel</button>
                                                    </div>
                                                    <div id="passwordErrorPersonal" class="password-message-minimal error" style="display: none;"></div>
                                                    <div id="passwordSuccessPersonal" class="password-message-minimal success" style="display: none;"></div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field">
                                        <div class="profile-field-label">Contact</div>
                                        <div class="profile-field-value" id="profileContactDisplay">
                                            <span id="profileContactText" style="color: var(--color-text-tertiary);">Not provided</span>
                                            <input type="text" class="profile-field-input" id="contact" placeholder="Phone number or email" style="display: none;">
                                    </div>
                                </div>
                                
                                    <div class="profile-field">
                                        <div class="profile-field-label">Job Title</div>
                                        <div class="profile-field-value" id="profileJobTitleDisplay">
                                            <span id="profileJobTitleText" style="color: var(--color-text-tertiary);">Not provided</span>
                                            <input type="text" class="profile-field-input" id="jobTitle" placeholder="e.g. Software Engineer, Student" style="display: none;">
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field">
                                        <div class="profile-field-label">Location</div>
                                        <div class="profile-field-value" id="profileLocationDisplay">
                                            <span id="profileLocationText" style="color: var(--color-text-tertiary);">Not provided</span>
                                            <input type="text" class="profile-field-input" id="location" placeholder="e.g. New York, USA" style="display: none;">
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field">
                                        <div class="profile-field-label">Website</div>
                                        <div class="profile-field-value" id="profileWebsiteDisplay">
                                            <span id="profileWebsiteText" style="color: var(--color-text-tertiary);">Not provided</span>
                                            <input type="url" class="profile-field-input" id="website" placeholder="https://yourwebsite.com" style="display: none;">
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field profile-field-bio">
                                        <div class="profile-field-label">Bio</div>
                                        <div class="profile-field-value" id="profileBioDisplay">
                                            <span id="profileBioText" style="color: var(--color-text-tertiary);">Add a bio to introduce yourself</span>
                                            <textarea class="profile-field-textarea" id="bio" placeholder="Tell us about yourself" rows="4" style="display: none;"></textarea>
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field profile-field-bio">
                                        <div class="profile-field-label">Learning Goals</div>
                                        <div class="profile-field-value" id="profileGoalsDisplay">
                                            <span id="profileGoalsText" style="color: var(--color-text-tertiary);">What do you want to achieve?</span>
                                            <textarea class="profile-field-textarea" id="learningGoals" placeholder="What are your learning objectives?" rows="3" style="display: none;"></textarea>
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field">
                                        <div class="profile-field-label">Social Links</div>
                                        <div class="profile-field-value" id="profileSocialDisplay" style="flex-direction: column; gap: var(--space-2);">
                                            <div id="profileSocialLogos" class="profile-social-logos" style="display: none; flex-wrap: wrap; gap: var(--space-3);"></div>
                                            <span id="profileSocialText" style="color: var(--color-text-tertiary);">Not provided</span>
                                            <div class="profile-social-inputs" style="display: none; flex-direction: column; gap: var(--space-2);">
                                                <input type="url" class="profile-field-input" id="socialTwitter" placeholder="Twitter/X profile URL" style="display: block;" data-social-type="twitter">
                                                <input type="url" class="profile-field-input" id="socialLinkedIn" placeholder="LinkedIn profile URL" style="display: block;" data-social-type="linkedIn">
                                                <input type="url" class="profile-field-input" id="socialGitHub" placeholder="GitHub profile URL" style="display: block;" data-social-type="github">
                                                <div id="dynamicSocialLinks" style="display: flex; flex-direction: column; gap: var(--space-2);"></div>
                                                <button type="button" id="addSocialBtn" class="add-social-btn" style="display: none;">
                                                    <span>Add Social +</span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="profile-edit-controls">
                                    <button class="btn btn-edit-profile" id="profileEditBtn">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
                                        </svg>
                                    </button>
                                    <div class="profile-edit-actions" id="profileEditActions" style="display: none;">
                                        <button class="btn btn-text-cancel" id="profileCancelBtn">Cancel</button>
                                        <button class="btn btn-primary" id="profileSaveBtn">Save</button>
                                    </div>
                                </div>
                            </div>
                </div>
                
                <!-- Google Account Subsection -->
                <div id="googleAccountSection" class="profile-subsection" style="display: none;">
                            <div class="profile-info-container">
                                <div class="profile-info-content">
                                    <div class="profile-field">
                                        <div class="profile-field-label">Member Since</div>
                                        <div class="profile-field-value">
                                            <span id="memberSinceText">â€”</span>
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field">
                                        <div class="profile-field-label">Account Type</div>
                                        <div class="profile-field-value">
                                            <span id="accountTypeText">Free</span>
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field">
                                        <div class="profile-field-label">Programs Enrolled</div>
                                        <div class="profile-field-value">
                                            <span id="programsEnrolledText">â€”</span>
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field">
                                        <div class="profile-field-label">Sign-In Method</div>
                                        <div class="profile-field-value">
                                            <span id="signInMethodText">â€”</span>
                                        </div>
                                    </div>
                                    
                                    <div class="profile-field">
                                        <div class="profile-field-label">Google Account</div>
                                        <div class="profile-field-value">
                                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                                <span id="googleAccountStatusText" style="color: var(--color-text-tertiary);">Not connected</span>
                                                <button class="btn btn-text-cancel" id="connectGoogleBtn" style="display: none; padding: 0; color: var(--color-brand-purple);">
                                                    Connect
                                                </button>
                                                <button class="btn btn-text-cancel" id="disconnectGoogleBtn" style="display: none; padding: 0; color: var(--color-text-tertiary);">
                                                    Disconnect
                                                </button>
                                            </div>
                                            <div id="googleAccountEmail" style="display: none; margin-top: var(--space-2); color: var(--color-text-secondary); font-size: 13px;"></div>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                </div>
                
                <!-- Account Preferences Subsection -->
                <div id="preferencesSection" class="profile-subsection" style="display: none;">
                            <div class="profile-info-container">
                                <div class="profile-info-content">
                                    <div class="profile-field">
                                        <div class="profile-field-label">Email Notifications</div>
                                        <div class="profile-field-value">
                                            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="emailNotificationsText">Enabled</span>
                                        </div>
                                        <div class="profile-field-toggle">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="emailNotificationsToggle" checked onchange="saveSettings()">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Marketing Emails</div>
                                        <div class="profile-field-value">
                                            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="marketingEmailsText">Disabled</span>
                                        </div>
                                        <div class="profile-field-toggle">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="marketingEmailsToggle" onchange="saveSettings()">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Push Notifications</div>
                                        <div class="profile-field-value">
                                            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Get browser notifications for important updates</span>
                                        </div>
                                        <div class="profile-field-toggle">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="pushNotificationsPref" onchange="saveSettings()">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Course Updates</div>
                                        <div class="profile-field-value">
                                            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Notifications when new content is added to your courses</span>
                                        </div>
                                        <div class="profile-field-toggle">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="courseUpdatesPref" onchange="saveSettings()">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Assignment Reminders</div>
                                        <div class="profile-field-value">
                                            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Remind me about upcoming assignments and deadlines</span>
                                        </div>
                                        <div class="profile-field-toggle">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="assignmentRemindersPref" onchange="saveSettings()">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Study Reminders</div>
                                        <div class="profile-field-value">
                                            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Daily reminders to keep your learning streak going</span>
                                        </div>
                                        <div class="profile-field-toggle">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="studyRemindersPref" onchange="saveSettings()">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Animations</div>
                                        <div class="profile-field-value">
                                            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Enable smooth transitions and animations</span>
                                        </div>
                                        <div class="profile-field-toggle">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="animationsPref" onchange="saveSettings()">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Compact Sidebar</div>
                                        <div class="profile-field-value">
                                            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Use a narrower sidebar to save space</span>
                                        </div>
                                        <div class="profile-field-toggle">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="compactSidebarPref" onchange="saveSettings()">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Auto-play Videos</div>
                                        <div class="profile-field-value">
                                            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Automatically play course videos when opened</span>
                                        </div>
                                        <div class="profile-field-toggle">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="autoPlayVideosPref" onchange="saveSettings()">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Progress Tracking</div>
                                        <div class="profile-field-value">
                                            <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Track and display your learning progress</span>
                                        </div>
                                        <div class="profile-field-toggle">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="progressTrackingPref" onchange="saveSettings()">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Language</div>
                                        <div class="profile-field-value">
                                            <select class="profile-field-input" id="languagePref" style="max-width: 250px; display: block;" onchange="saveLanguagePreference(this.value)">
                                                <option value="en">English</option>
                                                <option value="es">Spanish</option>
                                                <option value="fr">French</option>
                                                <option value="de">German</option>
                                                <option value="ja">Japanese</option>
                                                <option value="zh">Chinese</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="profile-field">
                                        <div class="profile-field-label">Timezone</div>
                                        <div class="profile-field-value">
                                            <select class="profile-field-input" id="timezonePref" style="max-width: 250px; display: block;" onchange="saveTimezonePreference(this.value)">
                                                <option value="UTC">UTC (Coordinated Universal Time)</option>
                                                <option value="America/New_York">Eastern Time (ET)</option>
                                                <option value="America/Chicago">Central Time (CT)</option>
                                                <option value="America/Denver">Mountain Time (MT)</option>
                                                <option value="America/Los_Angeles">Pacific Time (PT)</option>
                                                <option value="Europe/London">London (GMT)</option>
                                                <option value="Europe/Paris">Paris (CET)</option>
                                                <option value="Asia/Tokyo">Tokyo (JST)</option>
                                                <option value="Asia/Dubai">Dubai (GST)</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                </div>
                
                <!-- Advanced Section -->
                <div id="advancedSection" class="profile-subsection" style="display: none;">
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Profile Visibility</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="advancedVisibilityText">Public</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="advancedVisibilityToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Two-Factor Authentication</div>
                                <div class="profile-field-value">
                                    <span style="color: var(--color-text-tertiary);">Not enabled</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="advancedTwoFactorToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Show Email Publicly</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="advancedShowEmailText">Hidden</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="advancedShowEmailToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Activity Status</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="advancedActivityStatusText">Visible</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="advancedActivityStatusToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Active Sessions</div>
                                <div class="profile-field-value">
                                    <span style="color: var(--color-text-secondary);">Current device</span>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Timezone</div>
                                <div class="profile-field-value">
                                    <select class="profile-field-input" id="advancedTimezone" style="max-width: 250px;">
                                        <option value="UTC">UTC</option>
                                        <option value="America/New_York">Eastern Time (ET)</option>
                                        <option value="America/Chicago">Central Time (CT)</option>
                                        <option value="America/Denver">Mountain Time (MT)</option>
                                        <option value="America/Los_Angeles">Pacific Time (PT)</option>
                                        <option value="Europe/London">London (GMT)</option>
                                        <option value="Europe/Paris">Paris (CET)</option>
                                        <option value="Asia/Tokyo">Tokyo (JST)</option>
                                        <option value="Asia/Shanghai">Shanghai (CST)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Language</div>
                                <div class="profile-field-value">
                                    <select class="profile-field-input" id="advancedLanguage" style="max-width: 200px;">
                                        <option value="en">English</option>
                                        <option value="es">Spanish</option>
                                        <option value="fr">French</option>
                                        <option value="de">German</option>
                                        <option value="it">Italian</option>
                                        <option value="pt">Portuguese</option>
                                    </select>
                                </div>
                            </div>
                            <div class="profile-field" style="border-bottom: none;">
                                <div class="profile-field-label">Data Management</div>
                                <div class="profile-field-value" style="flex-direction: column; gap: var(--space-2); align-items: flex-start;">
                                    <a href="#" class="plan-action-link" id="advancedDownloadDataBtn">
                                        Download My Data
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left: 4px;">
                                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                            <polyline points="7 10 12 15 17 10"></polyline>
                                            <line x1="12" y1="15" x2="12" y2="3"></line>
                                        </svg>
                                    </a>
                                    <a href="#" class="plan-action-link" id="advancedDeleteAccountBtn" style="color: var(--color-text-tertiary);">
                                        Delete Account
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left: 4px;">
                                            <polyline points="3 6 5 6 21 6"></polyline>
                                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Security Section -->
                <div id="securitySection" class="profile-subsection" style="display: none;">
                    <div class="card-header">
                        <h3 class="card-title">Password & Security</h3>
                    </div>
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Current Password</div>
                                <div class="profile-field-value">
                                    <span>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</span>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Two-Factor Authentication</div>
                                <div class="profile-field-value">
                                    <span style="color: var(--color-text-tertiary);">Not enabled</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="twoFactorToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Last Password Change</div>
                                <div class="profile-field-value">
                                    <span style="color: var(--color-text-tertiary);">Never</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Privacy Section -->
                <div id="privacySection" class="profile-subsection" style="display: none;">
                    <div class="card-header">
                        <h3 class="card-title">Privacy Settings</h3>
                    </div>
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Profile Visibility</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="privacyVisibilityText">Public</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="privacyVisibilityToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Show Email Publicly</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="showEmailText">Hidden</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="showEmailToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Activity Status</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="activityStatusText">Visible</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="activityStatusToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Sessions Section -->
                <div id="sessionsSection" class="profile-subsection" style="display: none;">
                    <div class="card-header">
                        <h3 class="card-title">Active Sessions</h3>
                    </div>
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Current Session</div>
                                <div class="profile-field-value">
                                    <span style="color: var(--color-text-secondary);">This device</span>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Last Active</div>
                                <div class="profile-field-value">
                                    <span style="color: var(--color-text-secondary);">Just now</span>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Browser</div>
                                <div class="profile-field-value">
                                    <span style="color: var(--color-text-tertiary);">N/A</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Notifications Section -->
                <div id="notificationsSection" class="profile-subsection" style="display: none;">
                    <div class="card-header">
                        <h3 class="card-title">Notification Settings</h3>
                    </div>
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Email Notifications</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="notifEmailText">Enabled</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="notifEmailToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Push Notifications</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="notifPushText">Enabled</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="notifPushToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Course Updates</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="notifCourseText">Enabled</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="notifCourseToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Marketing Emails</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="notifMarketingText">Disabled</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="notifMarketingToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Appearance Section -->
                <div id="appearanceSection" class="profile-subsection" style="display: none;">
                    <div class="card-header">
                        <h3 class="card-title">Appearance Settings</h3>
                    </div>
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Theme</div>
                                <div class="profile-field-value">
                                    <select class="profile-field-input" id="themeSelect" style="max-width: 200px;">
                                        <option value="dark">Dark Mode</option>
                                        <option value="light">Light Mode</option>
                                        <option value="auto">Auto (System)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Compact Mode</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);" id="compactModeText">Disabled</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="compactModeToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="profile-field">
                                <div class="profile-field-label">Font Size</div>
                                <div class="profile-field-value">
                                    <select class="profile-field-input" id="fontSizeSelect" style="max-width: 200px;">
                                        <option value="small">Small</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="large">Large</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Right Side Navigation Panel -->
            <div class="profile-right-panel" id="profileRightPanel">
                <button class="profile-panel-collapse-btn" id="profilePanelToggle" title="Collapse panel">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
                <div class="profile-right-panel-header">
                    <div class="profile-panel-title">
                        <span style="font-size: var(--font-size-sm); font-weight: var(--font-weight-semibold); color: var(--color-text-tertiary); text-transform: uppercase; letter-spacing: 0.05em;">Profile Settings</span>
                    </div>
                </div>
                <nav class="profile-right-panel-nav">
                    <!-- Account Section -->
                    <div class="profile-panel-section">
                        <div class="profile-section-title">Account</div>
                        <div class="profile-nav-items">
                            <a href="#" class="profile-nav-item active" data-section="personalInfoSection" data-tooltip="Personal Info">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                </svg>
                                <span>Personal Info</span>
                            </a>
                            <a href="#" class="profile-nav-item" data-section="googleAccountSection" data-tooltip="Google Account">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="9" cy="7" r="4"></circle>
                                    <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                </svg>
                                <span>Google Account</span>
                            </a>
                            <a href="#" class="profile-nav-item" data-section="advancedSection" data-tooltip="Advanced">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"></path>
                                </svg>
                                <span>Advanced</span>
                            </a>
                        </div>
                    </div>
                    
                    <!-- Security Section -->
                    <div class="profile-panel-section">
                        <div class="profile-section-title">Security</div>
                        <div class="profile-nav-items">
                            <a href="#" class="profile-nav-item" data-section="securitySection" data-tooltip="Password & Security">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                                </svg>
                                <span>Password</span>
                            </a>
                            <a href="#" class="profile-nav-item" data-section="privacySection" data-tooltip="Privacy Settings">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                                </svg>
                                <span>Privacy</span>
                            </a>
                            <a href="#" class="profile-nav-item" data-section="sessionsSection" data-tooltip="Active Sessions">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                    <line x1="8" y1="21" x2="16" y2="21"></line>
                                    <line x1="12" y1="17" x2="12" y2="21"></line>
                                </svg>
                                <span>Sessions</span>
                            </a>
                        </div>
                    </div>
                    
                    <!-- Preferences Section -->
                    <div class="profile-panel-section">
                        <div class="profile-section-title">Preferences</div>
                        <div class="profile-nav-items">
                            <a href="#" class="profile-nav-item" data-section="preferencesSection" data-tooltip="General Preferences">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <path d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"></path>
                                </svg>
                                <span>General</span>
                            </a>
                            <a href="#" class="profile-nav-item" data-section="notificationsSection" data-tooltip="Notifications">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                                </svg>
                                <span>Notifications</span>
                            </a>
                            <a href="#" class="profile-nav-item" data-section="appearanceSection" data-tooltip="Appearance">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="5"></circle>
                                    <line x1="12" y1="1" x2="12" y2="3"></line>
                                    <line x1="12" y1="21" x2="12" y2="23"></line>
                                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                    <line x1="1" y1="12" x2="3" y2="12"></line>
                                    <line x1="21" y1="12" x2="23" y2="12"></line>
                                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                                </svg>
                                <span>Appearance</span>
                            </a>
                        </div>
                    </div>
                </nav>
            </div>

            <!-- Settings Section -->
            <section id="settings" class="content-section">
                <!-- Notifications -->
                <div class="settings-section">
                    <h3 class="settings-section-title">Notifications</h3>
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Email Notifications</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Receive email updates about your courses</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="emailNotifications" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="profile-field">
                                <div class="profile-field-label">Push Notifications</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Get browser notifications for updates</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="pushNotifications" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="profile-field">
                                <div class="profile-field-label">Course Updates</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">New content added to your courses</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="courseUpdates" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="profile-field">
                                <div class="profile-field-label">Assignment Reminders</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Upcoming assignments and deadlines</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="assignmentReminders" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="profile-field" style="border-bottom: none;">
                                <div class="profile-field-label">Study Reminders</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Daily reminders to keep learning</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="studyReminders" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Appearance -->
                <div class="settings-section">
                    <h3 class="settings-section-title">Appearance</h3>
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Always on Light Mode</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Override system preference</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="alwaysLightMode" onchange="saveThemeToggle()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="profile-field">
                                <div class="profile-field-label">Animations</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Enable smooth transitions</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="animations" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="profile-field">
                                <div class="profile-field-label">Compact Sidebar</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Use a narrower sidebar</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="compactSidebar" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="profile-field" style="border-bottom: none;">
                                <div class="profile-field-label">Auto-play Videos</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Automatically play course videos</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="autoPlayVideos" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Privacy -->
                <div class="settings-section">
                    <h3 class="settings-section-title">Privacy</h3>
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Profile Visibility</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Allow others to view your profile</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="profileVisibility" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="profile-field">
                                <div class="profile-field-label">Activity Status</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Show when you're online</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="activityStatus" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="profile-field" style="border-bottom: none;">
                                <div class="profile-field-label">Data Analytics</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Share anonymous usage data</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="dataAnalytics" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Learning & Regional -->
                <div class="settings-section">
                    <h3 class="settings-section-title">Learning & Regional</h3>
                    <div class="profile-info-container">
                        <div class="profile-info-content">
                            <div class="profile-field">
                                <div class="profile-field-label">Progress Tracking</div>
                                <div class="profile-field-value">
                                    <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Track your learning progress</span>
                                </div>
                                <div class="profile-field-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="progressTracking" onchange="saveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="profile-field">
                                <div class="profile-field-label">Language</div>
                                <div class="profile-field-value">
                                    <select class="profile-field-input" id="language" style="max-width: 250px; display: block;" onchange="saveLanguagePreference(this.value)">
                                        <option value="en">English</option>
                                        <option value="es">Spanish</option>
                                        <option value="fr">French</option>
                                        <option value="de">German</option>
                                        <option value="ja">Japanese</option>
                                        <option value="zh">Chinese</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="profile-field" style="border-bottom: none;">
                                <div class="profile-field-label">Timezone</div>
                                <div class="profile-field-value">
                                    <select class="profile-field-input" id="timezone" style="max-width: 250px; display: block;" onchange="saveTimezonePreference(this.value)">
                                        <option value="UTC">UTC (Coordinated Universal Time)</option>
                                        <option value="America/New_York">Eastern Time (ET)</option>
                                        <option value="America/Chicago">Central Time (CT)</option>
                                        <option value="America/Denver">Mountain Time (MT)</option>
                                        <option value="America/Los_Angeles">Pacific Time (PT)</option>
                                        <option value="Europe/London">London (GMT)</option>
                                        <option value="Europe/Paris">Paris (CET)</option>
                                        <option value="Asia/Tokyo">Tokyo (JST)</option>
                                        <option value="Asia/Dubai">Dubai (GST)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
    </main>

    <!-- Logout Confirmation Modal -->
    <div id="logoutModal" class="logout-modal">
        <div class="logout-modal-overlay"></div>
        <div class="logout-modal-content">
            <div class="logout-modal-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16,17 21,12 16,7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
            </div>
            <div class="logout-modal-header">
                <h3 class="logout-modal-title">Sign out of your account?</h3>
            </div>
            <div class="logout-modal-body">
                <p class="logout-modal-message">You'll need to sign in again to access your dashboard and continue learning.</p>
            </div>
            <div class="logout-modal-actions">
                <button class="logout-btn-cancel" id="logoutCancelBtn">Cancel</button>
                <button class="logout-btn-confirm" id="logoutConfirmBtn">Sign out</button>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="logout-modal" style="display: none;">
        <div class="logout-modal-overlay"></div>
        <div class="logout-modal-content">
            <div class="logout-modal-header">
                <h3 class="logout-modal-title">Change Password</h3>
            </div>
            <form
                id="changePasswordForm"
                class="logout-modal-body"
                style="padding: 0 0 var(--space-6) 0;"
                autocomplete="off"
                novalidate
                onsubmit="event.preventDefault();"
            >
                <input
                    type="text"
                    id="changePasswordUsernameField"
                    name="username"
                    autocomplete="username"
                    aria-hidden="true"
                    aria-label="Account email address"
                    tabindex="-1"
                    data-username-field
                    style="position: absolute; left: -9999px; opacity: 0; pointer-events: none; height: 1px; width: 1px;"
                >
                <div style="display: flex; flex-direction: column; gap: var(--space-4);">
                    <div class="password-form-field">
                        <label for="currentPassword" style="display: block; font-size: 13px; font-weight: 500; color: var(--color-text-secondary); margin-bottom: var(--space-2);">Current Password</label>
                        <input type="password" id="currentPassword" class="profile-field-input" placeholder="Enter current password" style="width: 100%; display: block;" autocomplete="current-password">
                    </div>
                    <div class="password-form-field">
                        <label for="newPassword" style="display: block; font-size: 13px; font-weight: 500; color: var(--color-text-secondary); margin-bottom: var(--space-2);">New Password</label>
                        <input type="password" id="newPassword" class="profile-field-input" placeholder="Enter new password" style="width: 100%; display: block;" autocomplete="new-password">
                    </div>
                    <div class="password-form-field">
                        <label for="confirmPassword" style="display: block; font-size: 13px; font-weight: 500; color: var(--color-text-secondary); margin-bottom: var(--space-2);">Confirm New Password</label>
                        <input type="password" id="confirmPassword" class="profile-field-input" placeholder="Confirm new password" style="width: 100%; display: block;" autocomplete="new-password">
                    </div>
                </div>
            </form>
            <div class="logout-modal-actions">
                <button type="button" class="logout-btn-cancel" id="changePasswordCancelBtn">Cancel</button>
                <button type="button" class="logout-btn-confirm" id="changePasswordConfirmBtn">Change Password</button>
            </div>
        </div>
    </div>

    <!-- Image Cropper Modal -->
    <div id="imageCropperModal" class="image-cropper-modal" style="display: none;">
        <div class="image-cropper-overlay"></div>
        <div class="image-cropper-content">
            <div class="image-cropper-header">
                <h3>Adjust Your Photo</h3>
                <button class="cropper-close-btn" id="cropperCloseBtn">Ã—</button>
            </div>
            <div class="image-cropper-body">
                <div class="cropper-container">
                    <img id="cropperImage" src="" alt="Crop preview">
                </div>
            </div>
            <div class="image-cropper-actions">
                <button class="cropper-btn-cancel" id="cropperCancelBtn">Cancel</button>
                <button class="cropper-btn-upload" id="cropperUploadBtn">Upload Photo</button>
            </div>
        </div>
    </div>

    <!-- Marketplace Filter Popup -->
    <div id="marketplaceFilterPopup" class="marketplace-filter-popup">
        <div class="marketplace-filter-overlay"></div>
        <div class="marketplace-filter-content">
            <div class="marketplace-filter-header">
                <h3 class="marketplace-filter-title">Filter Programs</h3>
                <button class="marketplace-filter-close" id="marketplaceFilterClose">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="marketplace-filter-body">
                <!-- Category Filter -->
                <div class="marketplace-filter-section">
                    <h4 class="marketplace-filter-section-title">Category</h4>
                    <div class="marketplace-filter-options">
                        <button class="marketplace-filter-option active" data-filter-type="category" data-value="all">
                            <span>All</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="category" data-value="ai">
                            <span>AI & Automation</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="category" data-value="business">
                            <span>Business</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="category" data-value="tech">
                            <span>Technology</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="category" data-value="design">
                            <span>Design</span>
                        </button>
                    </div>
                </div>

                <!-- Price Filter -->
                <div class="marketplace-filter-section">
                    <h4 class="marketplace-filter-section-title">Price</h4>
                    <div class="marketplace-filter-options">
                        <button class="marketplace-filter-option active" data-filter-type="price" data-value="all">
                            <span>All Prices</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="price" data-value="free">
                            <span>Free</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="price" data-value="under-50">
                            <span>Under $50</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="price" data-value="50-100">
                            <span>$50 - $100</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="price" data-value="100-200">
                            <span>$100 - $200</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="price" data-value="200-plus">
                            <span>$200+</span>
                        </button>
                    </div>
                </div>

                <!-- Difficulty Filter -->
                <div class="marketplace-filter-section">
                    <h4 class="marketplace-filter-section-title">Difficulty</h4>
                    <div class="marketplace-filter-options">
                        <button class="marketplace-filter-option active" data-filter-type="difficulty" data-value="all">
                            <span>All Levels</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="difficulty" data-value="beginner">
                            <span>Beginner</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="difficulty" data-value="intermediate">
                            <span>Intermediate</span>
                        </button>
                        <button class="marketplace-filter-option" data-filter-type="difficulty" data-value="advanced">
                            <span>Advanced</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="marketplace-filter-footer">
                <button class="marketplace-filter-clear" id="marketplaceFilterClear">Clear All</button>
                <button class="marketplace-filter-apply" id="marketplaceFilterApply">Apply Filters</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/js/navigation.js"></script>
    <script src="/js/routing.js"></script>
    <script type="module" src="/js/marketplace.js"></script>
    
    <!-- Help Search Handler -->
    <script>
        (function() {
            const helpInput = document.getElementById('helpSearchInput');
            const helpClearBtn = document.getElementById('helpSearchClear');
            
            if (helpInput && helpClearBtn) {
                helpInput.addEventListener('input', function() {
                    if (this.value) {
                        helpClearBtn.style.display = 'flex';
                    } else {
                        helpClearBtn.style.display = 'none';
                    }
                });
                
                helpClearBtn.addEventListener('click', function() {
                    helpInput.value = '';
                    helpClearBtn.style.display = 'none';
                    helpInput.focus();
                    // Trigger input event
                    const event = new Event('input', { bubbles: true });
                    helpInput.dispatchEvent(event);
                });
            }
        })();
    </script>
    
    <!-- Marketplace Search Autocomplete moved to js/marketplace-search.js -->
    <script src="/js/marketplace-search.js"></script>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, query, getDocs, doc, getDoc, updateDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getStorage } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';
        
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDZvKVOLry7oDekiRxZlY_7-u-Nfe15Zts",
            authDomain: "nuerlo-course-platform.firebaseapp.com",
            projectId: "nuerlo-course-platform",
            storageBucket: "nuerlo-course-platform.firebasestorage.app",
            messagingSenderId: "1089335169355",
            appId: "1:1089335169355:web:a327f39b892f5e752398ce",
            measurementId: "G-D6BX96Z7KN"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const analytics = getAnalytics(app);
        
        // Make Firebase available globally
        window.firebase = { auth, db, storage, analytics };
        window.firestoreFunctions = { collection, query, getDocs, doc, getDoc };
    </script>

    <script src="/js/stripe-subscriptions.js"></script>
    
    <!-- Progress Tracking -->
    <script src="/js/progress-tracking.js"></script>
    
    <script src="/js/dashboard.js"></script>
    <script src="/js/setup-guide.js"></script>
    <script src="/js/search-command.js"></script>
    
    <!-- Social Logo Path Fixer moved to js/social-links.js -->
    
    <!-- Theme & Sidebar Handler moved to js/theme-sidebar.js -->
    <script src="/js/theme-sidebar.js"></script>
    
    <!-- Dashboard Navigation Handler moved to js/dashboard-navigation.js -->
    <script src="/js/dashboard-navigation.js"></script>

    <!-- Marketplace Filter Dropdown moved to js/marketplace-filters.js -->
    <script src="/js/marketplace-filters.js"></script>

    <!-- User Info Loading moved to js/user-info.js (includes Firebase initialization check) -->
    <script src="/js/user-info.js"></script>
    
    <!-- Profile Navigation Handler moved to js/profile-navigation.js -->
    <script src="/js/profile-navigation.js"></script>
    
    <!-- Social Links Handler moved to js/social-links.js -->
    <script type="module" src="/js/social-links.js"></script>
    
    <!-- Settings Sync moved to js/settings-sync.js -->
    <script src="/js/settings-sync.js"></script>
    
    </div>
    <!-- End Auth Protected Content -->
</body>
</html>
